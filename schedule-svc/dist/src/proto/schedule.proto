syntax = "proto3";

package schedule.v1;

import "google/protobuf/timestamp.proto";

option go_package="github.com/qthuy2k1/thesis_management_backend/schedule/api/v1";

service ScheduleService {
    rpc GetSchedules(GetSchedulesRequest) returns (GetSchedulesResponse) {}

    rpc CreateSchedule(CreateScheduleRequest) returns (CreateScheduleResponse) {}


    rpc GetNotifications(GetNotificationsRequest) returns (GetNotificationsResponse) {}

    rpc CreateNotification(CreateNotificationRequest) returns (CreateNotificationResponse) {}

    rpc CreateOrUpdatePointDef(CreateOrUpdatePointDefRequest) returns (CreateOrUpdatePointDefResponse) {}

    rpc GetAllPointDefs(GetAllPointDefsRequest) returns (GetAllPointDefsResponse) {}

    rpc CreateAttachment(CreateAttachmentRequest) returns (CreateAttachmentResponse) {}
    rpc GetAttachment(GetAttachmentRequest) returns (GetAttachmentResponse) {}
}


message UserScheduleResponse {
    string id = 1;
    string class = 2;
    optional string major = 3;
    optional string phone = 4;
    string photoSrc = 5;
    string role = 6;
    string name = 7;
    string email = 8;
}

message StudentDefScheduleResponse {
    string id = 1;
    UserScheduleResponse infor = 2;
    UserScheduleResponse instructor = 3;
    google.protobuf.Timestamp createdAt = 4;
}

message TimeSlot {
    string date = 1;
    string shift = 2;
    string id = 3;
    string time = 4;
}

message RoomSchedule {
    string id = 1;
    string name = 2;
    string school = 3;
    string type = 4;
    string description = 5;
    string createdAt = 6;
}

message TimeSlots {
    StudentDefScheduleResponse student = 1;
    TimeSlot timeSlot = 2;
}

message Schedule {
    repeated TimeSlots timeSlots = 1;
    RoomSchedule room = 2;
}

message Thesis {
    Schedule schedule = 1;
    repeated UserScheduleResponse council = 2;
    string id = 3;
}

message ScheduleResponse {
    string id = 1;
    Thesis thesis = 2;
    google.protobuf.Timestamp createdAt = 3;
}

message GetSchedulesRequest{}

message GetSchedulesResponse{
    string id = 1;
    repeated Thesis thesis = 2;
    // google.protobuf.Timestamp createdAt = 3;
}


message CreateScheduleRequest{
    string startDate = 1;
    int64 quantityWeek = 2;
    repeated RoomSchedule rooms = 3;
    repeated UserScheduleResponse councils = 4;
    repeated StudentDefScheduleResponse studentDefs = 5;
}

message CreateScheduleResponse{
    string id = 1;
    repeated Thesis thesis = 2;
    // google.protobuf.Timestamp createdAt = 3;
}



// NOTIFICATION
message Notification {
    string id = 1;
    UserScheduleResponse senderUser = 2;
    UserScheduleResponse receiverAuthor = 3;
    string type = 4;
    google.protobuf.Timestamp createdAt = 5;
}


message GetNotificationsRequest {
}

message GetNotificationsResponse {
    repeated Notification notifications = 1;
}

message CreateNotificationRequest {
    Notification noti = 1;
}

message CreateNotificationResponse {
    Notification notification = 1;
    string message = 2;
    repeated Notification notifications = 3;
}


// ===========================
// POINT
message AssessItem {
    string id = 1;
    UserScheduleResponse lecturer = 2;
    int64 point = 3;
    string comment = 4;
}

message Point {
    string id = 1;
    UserScheduleResponse student = 2;
    repeated AssessItem assesses = 3;
}

message CreateOrUpdatePointDefRequest {
    Point point = 1;
}

message CreateOrUpdatePointDefResponse {
    Point point = 1;
    string message = 2;
}


message GetAllPointDefsRequest {
}

message GetAllPointDefsResponse {
    repeated Point points = 1;
}


message AttachmentExerciseInput {
    string fileURL = 1;
    string status = 2;
    string authorID = 3;
}
// ====== exercise ======
message ExerciseInput {
    string title = 1;
    string description = 2;
    ClassroomResponse classroom = 3;
    string deadline = 4;
    ReportingStageExerciseResponse categoryID = 5;
    AuthorExerciseResponse authorID = 6;
    repeated AttachmentExerciseInput attachments = 7;
}

message ExerciseResponse {
    string id = 1;
    string title = 2;
    string description = 3;
    ClassroomResponse classroomID = 4;
    string deadline = 5;
    ReportingStageExerciseResponse category = 6;
    AuthorExerciseResponse author = 7;
    google.protobuf.Timestamp createdAt = 8;
    google.protobuf.Timestamp updatedAt = 9;
    repeated AttachmentExerciseResponse attachments = 10;
}

message ClassroomResponse {
    int64 id = 1;
    string status = 4;
    AuthorExerciseResponse lecturer = 5;
    string classCourse = 6;
    optional string topicTags = 7;
    int64 quantityStudent = 8;
    google.protobuf.Timestamp createdAt = 9;
    google.protobuf.Timestamp updatedAt = 10;
}



message AttachmentExerciseResponse {
    string id = 1;
    string name = 2;
    string src = 3;
}

message ReportingStageExerciseResponse {
    int64 id = 1;
    string label = 2;
    string description = 3;   
    string value = 4;
}

message AuthorExerciseResponse {
    string id = 1;
    optional string class = 2;
    optional string major = 3;
    optional string phone = 4;
    string photoSrc = 5;
    string role = 6;
    string name = 7;
    string email = 8;
}

message CreateExerciseRequest {
   ExerciseInput exercise = 1; 
}

message CreateExerciseResponse {
    string message = 1;
}

message CreateAttachmentRequest{
    repeated string fileURL = 1;
    string uid = 2;
}

message CreateAttachmentResponse {
    repeated Attachment attachment = 1;
}

message Attachment{
    string id = 1;
    string name = 2; 
    string src = 3;
}

message GetAttachmentRequest{
    string id = 1;
}

message GetAttachmentResponse {
    repeated Attachment attachments = 1;
}